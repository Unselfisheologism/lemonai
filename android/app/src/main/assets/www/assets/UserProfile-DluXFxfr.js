import{s as T}from"./membership-QioX-G20.js";import{s as k}from"./auth-xyVyMPn2.js";import{u as Y}from"./user-BYcZl5Be.js";import{p as B,u as D,o as N,r,X as R,d as $,l as t,e as c,t as l,v as a,w as p,V as H,C as O,g as j,h as A,Q as E,U as Q,Z as X,f as U}from"./index-DfAoYx5F.js";import"./http-gFURT5VZ.js";const Z={class:"usage"},q={class:"account-management"},F={class:"username-section",style:{"margin-bottom":"16px"}},G={class:"label"},J={class:"password-reset-section"},K={class:"label"},W={__name:"UserProfile",setup(ee){const{user:m,membership:ae,points:te}=Y();j();const{t:e}=D();N(()=>{w()});const v=r(1),f=r(5),g=r(0),b=r([]),u=r(!1),d=r(""),i=r(!1),_=r(""),S=()=>{u.value=!0,d.value=m.user_name},P=async()=>{i.value=!0,_.value=""},C=async()=>{await k.updateUsername(d.value),u.value=!1,m.user_name=d.value,U.success(e("account.updateSuccess"))},h=async()=>{await k.resetPassword("",_.value,m.mobile),i.value=!1,U.success(e("account.updateSuccess"))},w=async()=>{const s=await T.getOrderList({page:v.value,pageSize:f.value});console.log(s),g.value=s.total,b.value=s.list},x=s=>{v.value=s.current,f.value=s.pageSize,w()},I=[{title:e("account.table.orderId"),dataIndex:"order_sn",key:"order_sn"},{title:e("account.table.orderAmount"),dataIndex:"amount",key:"amount"},{title:e("account.table.time"),dataIndex:"created_at",key:"created_at",customRender:({text:s})=>R(s).format("YYYY-MM-DD HH:mm")},{title:e("account.table.status"),key:"status",customRender:({record:s})=>{switch(s.status){case"pending":return e("account.orderStatus.pending");case"paid":return e("account.orderStatus.paid");case"cancelled":return e("account.orderStatus.cancelled");case"failed":return e("account.orderStatus.failed");default:return e("account.orderStatus.unknown")}}}];return(s,o)=>{const M=E,y=H,V=Q,z=X,L=O;return A(),$("div",Z,[t("div",q,[t("div",F,[t("div",null,[t("span",G,l(a(e)("account.usernameLabel")),1),t("span",null,l(a(m).user_name),1)]),t("button",{onClick:S},l(a(e)("account.edit")),1)]),t("div",J,[t("span",K,l(a(e)("account.passwordLabel")),1),t("button",{onClick:P},l(a(e)("account.resetPassword")),1)]),c(y,{centered:"",title:a(e)("account.editUsernameTitle"),open:u.value,"onUpdate:open":o[2]||(o[2]=n=>u.value=n)},{footer:p(()=>[t("button",{onClick:o[1]||(o[1]=n=>u.value=!1),style:{"background-color":"#0000330f","border-color":"#0000330f",color:"#1a1a19","margin-right":"8px"}},l(a(e)("account.cancel")),1),t("button",{type:"primary",onClick:C},l(a(e)("account.save")),1)]),default:p(()=>[c(M,{value:d.value,"onUpdate:value":o[0]||(o[0]=n=>d.value=n),placeholder:a(e)("account.newUsernamePlaceholder")},null,8,["value","placeholder"])]),_:1},8,["title","open"]),c(y,{centered:"",title:a(e)("account.resetPasswordTitle"),open:i.value,"onUpdate:open":o[5]||(o[5]=n=>i.value=n)},{footer:p(()=>[t("button",{onClick:o[4]||(o[4]=n=>i.value=!1),style:{"background-color":"#0000330f","border-color":"#0000330f",color:"#1a1a19","margin-right":"8px"}},l(a(e)("account.cancel")),1),t("button",{type:"primary",onClick:h},l(a(e)("account.save")),1)]),default:p(()=>[c(V,{value:_.value,"onUpdate:value":o[3]||(o[3]=n=>_.value=n),placeholder:a(e)("account.newPasswordPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["title","open"])]),c(L,{title:a(e)("account.ordersTitle")},{default:p(()=>[c(z,{columns:I,onChange:x,"data-source":b.value,"row-key":"id",pagination:{current:v.value,pageSize:f.value,page:v.value,total:g.value}},null,8,["data-source","pagination"])]),_:1},8,["title"])])}}},ce=B(W,[["__scopeId","data-v-a761aa2f"]]);export{ce as default};
